var ne=Object.defineProperty;var re=(e,t,i)=>t in e?ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var c=(e,t,i)=>re(e,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function i(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=i(r);fetch(r.href,s)}})();const bt=!1;var Rt=Array.isArray,se=Array.prototype.indexOf,oe=Array.from,ae=Object.defineProperty,x=Object.getOwnPropertyDescriptor,le=Object.getOwnPropertyDescriptors,ue=Object.prototype,fe=Array.prototype,Ot=Object.getPrototypeOf;function he(e){for(var t=0;t<e.length;t++)e[t]()}const T=2,Nt=4,gt=8,wt=16,N=32,K=64,it=128,b=256,nt=512,E=1024,C=2048,$=4096,rt=8192,ft=16384,ce=32768,de=65536,pe=1<<19,Ct=1<<20,J=Symbol("$state"),ve=Symbol("");function Ht(e){return e===this.v}function _e(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function ge(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function we(e){throw new Error("https://svelte.dev/e/effect_orphan")}function me(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ye(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Me(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Se(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function be(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Ee=!1;const ke=2,y=Symbol();function Te(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let m=null;function Et(e){m=e}function Lt(e,t=!1,i){m={p:m,c:null,e:null,m:!1,s:e,x:null,l:null}}function Ut(e){const t=m;if(t!==null){const a=t.e;if(a!==null){var i=_,n=v;t.e=null;try{for(var r=0;r<a.length;r++){var s=a[r];X(s.effect),B(s.reaction),mt(s.fn)}}finally{X(i),B(n)}}m=t.p,t.m=!0}return{}}function Yt(){return!0}function A(e,t){var i={f:0,v:e,reactions:null,equals:Ht,rv:0,wv:0};return i}function kt(e){return Pe(A(e))}function Pe(e){return v!==null&&!k&&(v.f&T)!==0&&(D===null?Ve([e]):D.push(e)),e}function P(e,t){return v!==null&&!k&&Yt()&&(v.f&(T|wt))!==0&&(D===null||!D.includes(e))&&be(),De(e,t)}function De(e,t){return e.equals(t)||(e.v,e.v=t,e.wv=Qt(),Wt(e,C),_!==null&&(_.f&E)!==0&&(_.f&(N|K))===0&&(z===null?Ge([e]):z.push(e))),t}function Wt(e,t){var i=e.reactions;if(i!==null)for(var n=i.length,r=0;r<n;r++){var s=i[r],a=s.f;(a&C)===0&&(O(s,t),(a&(E|b))!==0&&((a&T)!==0?Wt(s,$):St(s)))}}function I(e,t=null,i){if(typeof e!="object"||e===null||J in e)return e;const n=Ot(e);if(n!==ue&&n!==fe)return e;var r=new Map,s=Rt(e),a=A(0);s&&r.set("length",A(e.length));var p;return new Proxy(e,{defineProperty(h,o,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&ye();var f=r.get(o);return f===void 0?(f=A(u.value),r.set(o,f)):P(f,I(u.value,p)),!0},deleteProperty(h,o){var u=r.get(o);if(u===void 0)o in h&&r.set(o,A(y));else{if(s&&typeof o=="string"){var f=r.get("length"),l=Number(o);Number.isInteger(l)&&l<f.v&&P(f,l)}P(u,y),Tt(a)}return!0},get(h,o,u){var g;if(o===J)return e;var f=r.get(o),l=o in h;if(f===void 0&&(!l||(g=x(h,o))!=null&&g.writable)&&(f=A(I(l?h[o]:y,p)),r.set(o,f)),f!==void 0){var d=L(f);return d===y?void 0:d}return Reflect.get(h,o,u)},getOwnPropertyDescriptor(h,o){var u=Reflect.getOwnPropertyDescriptor(h,o);if(u&&"value"in u){var f=r.get(o);f&&(u.value=L(f))}else if(u===void 0){var l=r.get(o),d=l==null?void 0:l.v;if(l!==void 0&&d!==y)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return u},has(h,o){var d;if(o===J)return!0;var u=r.get(o),f=u!==void 0&&u.v!==y||Reflect.has(h,o);if(u!==void 0||_!==null&&(!f||(d=x(h,o))!=null&&d.writable)){u===void 0&&(u=A(f?I(h[o],p):y),r.set(o,u));var l=L(u);if(l===y)return!1}return f},set(h,o,u,f){var H;var l=r.get(o),d=o in h;if(s&&o==="length")for(var g=u;g<l.v;g+=1){var S=r.get(g+"");S!==void 0?P(S,y):g in h&&(S=A(y),r.set(g+"",S))}l===void 0?(!d||(H=x(h,o))!=null&&H.writable)&&(l=A(void 0),P(l,I(u,p)),r.set(o,l)):(d=l.v!==y,P(l,I(u,p)));var Y=Reflect.getOwnPropertyDescriptor(h,o);if(Y!=null&&Y.set&&Y.set.call(f,u),!d){if(s&&typeof o=="string"){var G=r.get("length"),W=Number(o);Number.isInteger(W)&&W>=G.v&&P(G,W+1)}Tt(a)}return!0},ownKeys(h){L(a);var o=Reflect.ownKeys(h).filter(l=>{var d=r.get(l);return d===void 0||d.v!==y});for(var[u,f]of r)f.v!==y&&!(u in h)&&o.push(u);return o},setPrototypeOf(){Me()}})}function Tt(e,t=1){P(e,e.v+t)}var Pt,qt,Bt,Xt;function Ae(){if(Pt===void 0){Pt=window,qt=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype;Bt=x(t,"firstChild").get,Xt=x(t,"nextSibling").get,e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__styles=null,e.__e=void 0,Text.prototype.__t=void 0}}function ze(e=""){return document.createTextNode(e)}function $t(e){return Bt.call(e)}function Ie(e){return Xt.call(e)}function Fe(e,t){return $t(e)}function Re(e){var t=T|C,i=v!==null&&(v.f&T)!==0?v:null;return _===null||i!==null&&(i.f&b)!==0?t|=b:_.f|=Ct,{ctx:m,deps:null,effects:null,equals:Ht,f:t,fn:e,reactions:null,rv:0,v:null,wv:0,parent:i??_}}function xt(e){var t=e.effects;if(t!==null){e.effects=null;for(var i=0;i<t.length;i+=1)U(t[i])}}function Oe(e){for(var t=e.parent;t!==null;){if((t.f&T)===0)return t;t=t.parent}return null}function Ne(e){var t,i=_;X(Oe(e));try{xt(e),t=ee(e)}finally{X(i)}return t}function jt(e){var t=Ne(e),i=(R||(e.f&b)!==0)&&e.deps!==null?$:E;O(e,i),e.equals(t)||(e.v=t,e.wv=Qt())}function Ce(e){_===null&&v===null&&we(),v!==null&&(v.f&b)!==0&&_===null&&ge(),yt&&_e()}function He(e,t){var i=t.last;i===null?t.last=t.first=e:(i.next=e,e.prev=i,t.last=e)}function V(e,t,i,n=!0){var r=(e&K)!==0,s=_,a={ctx:m,deps:null,nodes_start:null,nodes_end:null,f:e|C,first:null,fn:t,last:null,next:null,parent:r?null:s,prev:null,teardown:null,transitions:null,wv:0};if(i)try{Mt(a),a.f|=ce}catch(o){throw U(a),o}else t!==null&&St(a);var p=i&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&(Ct|it))===0;if(!p&&!r&&n&&(s!==null&&He(a,s),v!==null&&(v.f&T)!==0)){var h=v;(h.effects??(h.effects=[])).push(a)}return a}function Le(e){Ce();var t=_!==null&&(_.f&N)!==0&&m!==null&&!m.m;if(t){var i=m;(i.e??(i.e=[])).push({fn:e,effect:_,reaction:v})}else{var n=mt(e);return n}}function Ue(e){const t=V(K,e,!0);return(i={})=>new Promise(n=>{i.outro?$e(t,()=>{U(t),n(void 0)}):(U(t),n(void 0))})}function mt(e){return V(Nt,e,!1)}function Ye(e){return V(gt,e,!0)}function We(e,t=[],i=Re){const n=t.map(i);return qe(()=>e(...n.map(L)))}function qe(e,t=0){return V(gt|wt|t,e,!0)}function Be(e,t=!0){return V(gt|N,e,!0,t)}function Kt(e){var t=e.teardown;if(t!==null){const i=yt,n=v;Dt(!0),B(null);try{t.call(null)}finally{Dt(i),B(n)}}}function Vt(e,t=!1){var i=e.first;for(e.first=e.last=null;i!==null;){var n=i.next;U(i,t),i=n}}function Xe(e){for(var t=e.first;t!==null;){var i=t.next;(t.f&N)===0&&U(t),t=i}}function U(e,t=!0){var i=!1;if((t||(e.f&pe)!==0)&&e.nodes_start!==null){for(var n=e.nodes_start,r=e.nodes_end;n!==null;){var s=n===r?null:Ie(n);n.remove(),n=s}i=!0}Vt(e,t&&!i),lt(e,0),O(e,ft);var a=e.transitions;if(a!==null)for(const h of a)h.stop();Kt(e);var p=e.parent;p!==null&&p.first!==null&&Gt(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=null}function Gt(e){var t=e.parent,i=e.prev,n=e.next;i!==null&&(i.next=n),n!==null&&(n.prev=i),t!==null&&(t.first===e&&(t.first=n),t.last===e&&(t.last=i))}function $e(e,t){var i=[];Zt(e,i,!0),xe(i,()=>{U(e),t&&t()})}function xe(e,t){var i=e.length;if(i>0){var n=()=>--i||t();for(var r of e)r.out(n)}else t()}function Zt(e,t,i){if((e.f&rt)===0){if(e.f^=rt,e.transitions!==null)for(const a of e.transitions)(a.is_global||i)&&t.push(a);for(var n=e.first;n!==null;){var r=n.next,s=(n.f&de)!==0||(n.f&N)!==0;Zt(n,t,s?i:!1),n=r}}}let st=[];function je(){var e=st;st=[],he(e)}function Ke(e){st.length===0&&queueMicrotask(je),st.push(e)}let Q=!1,dt=!1,ot=null,tt=!1,yt=!1;function Dt(e){yt=e}let et=[];let v=null,k=!1;function B(e){v=e}let _=null;function X(e){_=e}let D=null;function Ve(e){D=e}let w=null,M=0,z=null;function Ge(e){z=e}let Jt=1,at=0,R=!1;function Qt(){return++Jt}function ht(e){var f;var t=e.f;if((t&C)!==0)return!0;if((t&$)!==0){var i=e.deps,n=(t&b)!==0;if(i!==null){var r,s,a=(t&nt)!==0,p=n&&_!==null&&!R,h=i.length;if(a||p){var o=e,u=o.parent;for(r=0;r<h;r++)s=i[r],(a||!((f=s==null?void 0:s.reactions)!=null&&f.includes(o)))&&(s.reactions??(s.reactions=[])).push(o);a&&(o.f^=nt),p&&u!==null&&(u.f&b)===0&&(o.f^=b)}for(r=0;r<h;r++)if(s=i[r],ht(s)&&jt(s),s.wv>e.wv)return!0}(!n||_!==null&&!R)&&O(e,E)}return!1}function Ze(e,t){for(var i=t;i!==null;){if((i.f&it)!==0)try{i.fn(e);return}catch{i.f^=it}i=i.parent}throw Q=!1,e}function Je(e){return(e.f&ft)===0&&(e.parent===null||(e.parent.f&it)===0)}function ct(e,t,i,n){if(Q){if(i===null&&(Q=!1),Je(t))throw e;return}i!==null&&(Q=!0);{Ze(e,t);return}}function te(e,t,i=!0){var n=e.reactions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];(s.f&T)!==0?te(s,t,!1):t===s&&(i?O(s,C):(s.f&E)!==0&&O(s,$),St(s))}}function ee(e){var d;var t=w,i=M,n=z,r=v,s=R,a=D,p=m,h=k,o=e.f;w=null,M=0,z=null,R=(o&b)!==0&&(k||!tt||v===null),v=(o&(N|K))===0?e:null,D=null,Et(e.ctx),k=!1,at++;try{var u=(0,e.fn)(),f=e.deps;if(w!==null){var l;if(lt(e,M),f!==null&&M>0)for(f.length=M+w.length,l=0;l<w.length;l++)f[M+l]=w[l];else e.deps=f=w;if(!R)for(l=M;l<f.length;l++)((d=f[l]).reactions??(d.reactions=[])).push(e)}else f!==null&&M<f.length&&(lt(e,M),f.length=M);if(Yt()&&z!==null&&!k&&f!==null&&(e.f&(T|$|C))===0)for(l=0;l<z.length;l++)te(z[l],e);return r!==null&&at++,u}finally{w=t,M=i,z=n,v=r,R=s,D=a,Et(p),k=h}}function Qe(e,t){let i=t.reactions;if(i!==null){var n=se.call(i,e);if(n!==-1){var r=i.length-1;r===0?i=t.reactions=null:(i[n]=i[r],i.pop())}}i===null&&(t.f&T)!==0&&(w===null||!w.includes(t))&&(O(t,$),(t.f&(b|nt))===0&&(t.f^=nt),xt(t),lt(t,0))}function lt(e,t){var i=e.deps;if(i!==null)for(var n=t;n<i.length;n++)Qe(e,i[n])}function Mt(e){var t=e.f;if((t&ft)===0){O(e,E);var i=_,n=m,r=tt;_=e,tt=!0;try{(t&wt)!==0?Xe(e):Vt(e),Kt(e);var s=ee(e);e.teardown=typeof s=="function"?s:null,e.wv=Jt;var a=e.deps,p;bt&&Ee&&e.f&C}catch(h){ct(h,e,i,n||e.ctx)}finally{tt=r,_=i}}}function ti(){try{me()}catch(e){if(ot!==null)ct(e,ot,null);else throw e}}function ei(){try{for(var e=0;et.length>0;){e++>1e3&&ti();var t=et,i=t.length;et=[];for(var n=0;n<i;n++){var r=t[n];(r.f&E)===0&&(r.f^=E);var s=ni(r);ii(s)}}}finally{dt=!1,ot=null}}function ii(e){var t=e.length;if(t!==0)for(var i=0;i<t;i++){var n=e[i];if((n.f&(ft|rt))===0)try{ht(n)&&(Mt(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null?Gt(n):n.fn=null))}catch(r){ct(r,n,null,n.ctx)}}}function St(e){dt||(dt=!0,queueMicrotask(ei));for(var t=ot=e;t.parent!==null;){t=t.parent;var i=t.f;if((i&(K|N))!==0){if((i&E)===0)return;t.f^=E}}et.push(t)}function ni(e){var t=[],i=e.first;t:for(;i!==null;){var n=i.f,r=(n&N)!==0,s=r&&(n&E)!==0,a=i.next;if(!s&&(n&rt)===0){if((n&Nt)!==0)t.push(i);else if(r)i.f^=E;else{var p=v;try{v=i,ht(i)&&Mt(i)}catch(u){ct(u,i,null,i.ctx)}finally{v=p}}var h=i.first;if(h!==null){i=h;continue}}if(a===null){let u=i.parent;for(;u!==null;){if(e===u)break t;var o=u.next;if(o!==null){i=o;continue t}u=u.parent}}i=a}return t}function L(e){var t=e.f,i=(t&T)!==0;if(v!==null&&!k){D!==null&&D.includes(e)&&Se();var n=v.deps;e.rv<at&&(e.rv=at,w===null&&n!==null&&n[M]===e?M++:w===null?w=[e]:(!R||!w.includes(e))&&w.push(e))}else if(i&&e.deps===null&&e.effects===null){var r=e,s=r.parent;s!==null&&(s.f&b)===0&&(r.f^=b)}return i&&(r=e,ht(r)&&jt(r)),e.v}function ie(e){var t=k;try{return k=!0,e()}finally{k=t}}const ri=-7169;function O(e,t){e.f=e.f&ri|t}const si=["touchstart","touchmove"];function oi(e){return si.includes(e)}const ai=new Set,At=new Set;function Z(e){var W;var t=this,i=t.ownerDocument,n=e.type,r=((W=e.composedPath)==null?void 0:W.call(e))||[],s=r[0]||e.target,a=0,p=e.__root;if(p){var h=r.indexOf(p);if(h!==-1&&(t===document||t===window)){e.__root=t;return}var o=r.indexOf(t);if(o===-1)return;h<=o&&(a=h)}if(s=r[a]||e.target,s!==t){ae(e,"currentTarget",{configurable:!0,get(){return s||i}});var u=v,f=_;B(null),X(null);try{for(var l,d=[];s!==null;){var g=s.assignedSlot||s.parentNode||s.host||null;try{var S=s["__"+n];if(S!==void 0&&(!s.disabled||e.target===s))if(Rt(S)){var[Y,...G]=S;Y.apply(s,[e,...G])}else S.call(s,e)}catch(H){l?d.push(H):l=H}if(e.cancelBubble||g===t||g===null)break;s=g}if(l){for(let H of d)queueMicrotask(()=>{throw H});throw l}}finally{e.__root=t,delete e.currentTarget,B(u),X(f)}}}function li(e){var t=document.createElement("template");return t.innerHTML=e,t.content}function ui(e,t){var i=_;i.nodes_start===null&&(i.nodes_start=e,i.nodes_end=t)}function fi(e,t){var i=(t&ke)!==0,n,r=!e.startsWith("<!>");return()=>{n===void 0&&(n=li(r?e:"<!>"+e),n=$t(n));var s=i||qt?document.importNode(n,!0):n.cloneNode(!0);return ui(s,s),s}}function hi(e,t){e!==null&&e.before(t)}function ci(e,t){return di(e,t)}const q=new Map;function di(e,{target:t,anchor:i,props:n={},events:r,context:s,intro:a=!0}){Ae();var p=new Set,h=f=>{for(var l=0;l<f.length;l++){var d=f[l];if(!p.has(d)){p.add(d);var g=oi(d);t.addEventListener(d,Z,{passive:g});var S=q.get(d);S===void 0?(document.addEventListener(d,Z,{passive:g}),q.set(d,1)):q.set(d,S+1)}}};h(oe(ai)),At.add(h);var o=void 0,u=Ue(()=>{var f=i??t.appendChild(ze());return Be(()=>{if(s){Lt({});var l=m;l.c=s}r&&(n.$$events=r),o=e(f,n)||{},s&&Ut()}),()=>{var g;for(var l of p){t.removeEventListener(l,Z);var d=q.get(l);--d===0?(document.removeEventListener(l,Z),q.delete(l)):q.set(l,d)}At.delete(h),f!==i&&((g=f.parentNode)==null||g.removeChild(f))}});return pi.set(o,u),o}let pi=new WeakMap;function zt(e,t,i,n){var r=e.__attributes??(e.__attributes={});r[t]!==(r[t]=i)&&(t==="style"&&"__styles"in e&&(e.__styles={}),t==="loading"&&(e[ve]=i),i==null?e.removeAttribute(t):typeof i!="string"&&vi(e).includes(t)?e[t]=i:e.setAttribute(t,i))}var It=new Map;function vi(e){var t=It.get(e.nodeName);if(t)return t;It.set(e.nodeName,t=[]);for(var i,n=e,r=Element.prototype;r!==n;){i=le(n);for(var s in i)i[s].set&&t.push(s);n=Ot(n)}return t}function Ft(e,t){return e===t||(e==null?void 0:e[J])===t}function _i(e={},t,i,n){return mt(()=>{var r,s;return Ye(()=>{r=s,s=[],ie(()=>{e!==i(...s)&&(t(e,...s),r&&Ft(i(...r),e)&&t(null,...r))})}),()=>{Ke(()=>{s&&Ft(i(...s),e)&&t(null,...s)})}}),e}function gi(e){m===null&&Te(),Le(()=>{const t=ie(e);if(typeof t=="function")return t})}const wi="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(wi);const j=class j{constructor(){c(this,"fps",0);c(this,"frametimes",new Array(j.maxSample))}update(t){this.frametimes.push(t),this.frametimes.length>j.maxSample&&this.frametimes.shift(),this.fps=1e3/this.avgFrametime}get avgFrametime(){return this.frametimes.reduce((t,i)=>t+i,0)/this.frametimes.length}draw(t){t.fillStyle="black",t.fillRect(0,0,40,20),t.fillStyle="white",t.font="bold 15px Roboto",t.fillText(this.fps.toFixed(0),5,15)}};c(j,"maxSample",100);let pt=j;class mi{constructor(t,i=500,n=.1){this.position=t,this.edgeMargin=i,this.smoothingFactor=n}update(t,i,n,r,s,a){const p=Math.max(0,n-s),h=Math.max(0,r-a);let[o,u]=this.position.unpack();const[f,l]=i.unpack(),d=this.edgeMargin;f<this.position.x+d?o=Math.max(0,f-d):f>this.position.x+s-d&&(o=Math.min(p,f+d-s)),l<this.position.y+d?u=Math.max(0,l-d):l>this.position.y+a-d&&(u=Math.min(h,l+d-a)),this.position.x+=(o-this.position.x)*this.smoothingFactor*t,this.position.y+=(u-this.position.y)*this.smoothingFactor*t,this.position.x=Math.max(0,Math.min(this.position.x,p)),this.position.y=Math.max(0,Math.min(this.position.y,h))}}class F{constructor(t=0,i=0){this.x=t,this.y=i}unpack(){return[this.x,this.y]}sub(t){return new F(this.x-t.x,this.y-t.y)}lengh(){return Math.sqrt(this.x**2+this.y**2)}distance(t){return this.sub(t).lengh()}clone(){return new F(this.x,this.y)}}const yi=e=>{const t=Math.floor(e/60),i=e%60;return[t,i]};class Mi{constructor(t){c(this,"img");const i=new Image;i.src=`${t}`,this.img=i}getSize(t=1){return[this.img.width*t,this.img.height*t]}get handle(){return this.img}}class Si{constructor(t){c(this,"debug",!1);c(this,"speed",.5);c(this,"angle",0);c(this,"sprite");c(this,"direction",0);c(this,"scaleFactor",.5);c(this,"turnRate",.03);c(this,"bankAngle",0);c(this,"maxBankAngle",Math.PI/10);c(this,"bankSmoothing",.05);this.position=t,this.sprite=new Mi("/aircraft2.png")}update(t){const i=this.direction*this.maxBankAngle;this.bankAngle+=(i-this.bankAngle)*this.bankSmoothing*t,this.angle+=this.direction*this.turnRate,this.position.x+=Math.cos(this.angle)*this.speed*t,this.position.y+=Math.sin(this.angle)*this.speed*t}get size(){return this.sprite.getSize(this.scaleFactor)}turnTo(t){this.direction=t}draw(t){const[i,n]=this.position.unpack(),[r,s]=this.size;t.save(),t.translate(i,n),t.rotate(this.angle+Math.PI/2+this.bankAngle),t.drawImage(this.sprite.handle,-r,-s,r,s),this.debug&&(t.strokeStyle="green",t.rect(-r,-s,r,s),t.stroke()),t.restore()}}class bi{constructor(t,i){c(this,"size");c(this,"color");this.position=t;const n=Math.max(.3,Math.min(1,1-this.position.y/i));this.size=40+n*80;const r=.3+n*.5;this.color=`rgba(230, 230, 230, ${r})`}draw(t){const[i,n]=this.position.unpack();t.fillStyle=this.color,t.beginPath(),t.arc(i,n,this.size*.6,0,Math.PI*2),t.arc(i+this.size*.5,n-this.size*.3,this.size*.4,0,Math.PI*2),t.arc(i-this.size*.5,n-this.size*.3,this.size*.4,0,Math.PI*2),t.arc(i+this.size*.8,n,this.size*.3,0,Math.PI*2),t.arc(i-this.size*.8,n,this.size*.3,0,Math.PI*2),t.closePath(),t.fill()}}var vt=(e=>(e.W="w",e.A="a",e.S="s",e.D="d",e.Space=" ",e.Escape="Escape",e))(vt||{});class Ei{constructor(){c(this,"keys");c(this,"mouseXY");c(this,"buttons");c(this,"keyDownHandler");c(this,"keyUpHandler");c(this,"mouseDownHandler");c(this,"mouseUpHandler");this.mouseXY=[0,0],this.keys=new Set,this.buttons=new Set,this.keyDownHandler=this.onKeyDown.bind(this),this.keyUpHandler=this.onKeyUp.bind(this),this.mouseDownHandler=this.onMouseDown.bind(this),this.mouseUpHandler=this.onMouseUp.bind(this)}bindWindowAndDocument(){this.unbindWindowAndDocument(),window.addEventListener("keydown",this.keyDownHandler),window.addEventListener("keyup",this.keyUpHandler),document.addEventListener("mousedown",this.mouseDownHandler),document.addEventListener("mouseup",this.mouseUpHandler)}unbindWindowAndDocument(){window.removeEventListener("keydown",this.keyDownHandler),window.removeEventListener("keyup",this.keyUpHandler),document.removeEventListener("mousedown",this.mouseDownHandler),document.removeEventListener("mouseup",this.mouseUpHandler)}onMouseDown(t){this.buttons.add(t.button)}onMouseUp(t){this.buttons.delete(t.button)}onKeyDown(t){this.keys.add(t.key)}onKeyUp(t){this.keys.delete(t.key)}getMouseXY(){return this.mouseXY}isKeyDown(t){return this.keys.has(t)}isMouseDown(t){return this.buttons.has(t)}}class ki{constructor(t){c(this,"step");c(this,"circleRadius",10);c(this,"starRadius");c(this,"rotationSpeed",.002);c(this,"spike",5);c(this,"starSizeFactor",.7);c(this,"angle",0);this.position=t,this.step=Math.PI/this.spike,this.starRadius=this.circleRadius*this.starSizeFactor}update(t){this.angle-=this.rotationSpeed*t}draw(t){const[i,n]=this.position.unpack();t.fillStyle="white",t.beginPath(),t.arc(i,n,this.circleRadius,0,2*Math.PI),t.stroke(),t.fill(),t.closePath(),t.save(),t.translate(i,n),t.rotate(this.angle),t.beginPath(),t.fillStyle="yellow";for(let r=0;r<this.spike;r++){let s=r*2*Math.PI/this.spike,a=this.starRadius*Math.cos(s),p=this.starRadius*Math.sin(s);t.lineTo(a,p),s+=this.step,a=this.starRadius/2*Math.cos(s),p=this.starRadius/2*Math.sin(s),t.lineTo(a,p)}t.closePath(),t.stroke(),t.fill(),t.restore()}}const ut=class ut{constructor(t,i){c(this,"angle",0);c(this,"turnRate",.003);c(this,"speed",.6);this.position=t,this.target=i}update(t){const i=this.target.sub(this.position),r=(Math.atan2(i.y,i.x)-this.angle+Math.PI)%(2*Math.PI)-Math.PI;this.angle+=Math.sign(r)*Math.min(Math.abs(r),this.turnRate*t),this.position.x+=Math.cos(this.angle)*this.speed*t,this.position.y+=Math.sin(this.angle)*this.speed*t}checkCollision(t){return this===t?!1:this.position.distance(t.position)<=ut.collisionThreshold}draw(t){t.save(),t.translate(this.position.x,this.position.y),t.rotate(this.angle+Math.PI/2),t.fillStyle="gray",t.beginPath(),t.moveTo(0,-15),t.lineTo(-5,-10),t.lineTo(-5,10),t.lineTo(5,10),t.lineTo(5,-10),t.closePath(),t.fill(),t.fillStyle="darkgray",t.beginPath(),t.moveTo(-5,10),t.lineTo(-10,20),t.lineTo(0,15),t.closePath(),t.fill(),t.beginPath(),t.moveTo(5,10),t.lineTo(10,20),t.lineTo(0,15),t.closePath(),t.fill(),t.fillStyle="orange",t.beginPath(),t.moveTo(-3,15),t.lineTo(0,30),t.lineTo(3,15),t.closePath(),t.fill(),t.restore()}};c(ut,"collisionThreshold",20);let _t=ut;class Ti{constructor(t,i=1200){c(this,"elapsedTime",0);c(this,"maxSize");c(this,"isFinished",!1);c(this,"particles",[]);this.position=t,this.duration=i,this.maxSize=50+Math.random()*50,this.generateParticles()}generateParticles(){const t=10+Math.random()*20;for(let i=0;i<t;i++){const n=Math.random()*Math.PI*2,r=1+Math.random()*2;this.particles.push({x:this.position.x,y:this.position.y,size:5+Math.random()*10,velocity:new F(Math.cos(n)*r,Math.sin(n)*r),life:.5+Math.random()*.5})}}update(t){this.elapsedTime+=t,this.elapsedTime>=this.duration&&(this.isFinished=!0),this.particles.forEach(i=>{i.x+=i.velocity.x*t*100,i.y+=i.velocity.y*t*100,i.life-=t}),this.particles=this.particles.filter(i=>i.life>0)}draw(t){const i=this.elapsedTime/this.duration,n=this.maxSize*i,r=1-i;t.save(),t.translate(this.position.x,this.position.y),t.fillStyle=`rgba(255, ${150+Math.random()*100}, 0, ${r})`,t.beginPath(),t.arc(0,0,n,0,Math.PI*2),t.fill(),this.particles.forEach(s=>{t.fillStyle=`rgba(255, ${Math.random()*255}, 0, ${s.life})`,t.beginPath(),t.arc(s.x-this.position.x,s.y-this.position.y,s.size,0,Math.PI*2),t.fill()}),t.restore()}}class Pi{constructor(t){c(this,"startTime",Date.now());c(this,"maxMissilePool",3);c(this,"missileSpawnIntv",5e3);c(this,"input");c(this,"clouds",[]);c(this,"perfM");c(this,"camera");c(this,"aircraft");c(this,"worldSizeFactor",5);c(this,"star",null);c(this,"missiles",new Set);c(this,"explosions",[]);this.canvas=t,this.perfM=new pt;const[i,n]=this.canvasMidpoint;this.aircraft=new Si(new F(i,n)),this.camera=new mi(new F),this.populateClouds(),this.spawnStar(),this.startMissileSpawn(),this.input=new Ei,this.input.bindWindowAndDocument()}update(t){var r;const[i,n]=this.getWorldSize();this.updateAircraft(t),this.handleBounds(i,n);for(const s of this.missiles){s.update(t);for(const a of this.missiles)s.checkCollision(a)&&(this.missiles.delete(s),this.missiles.delete(a),this.explosions.push(new Ti(s.position)))}for(const s of this.explosions)s.isFinished||s.update(t);this.camera.update(t,this.aircraft.position,i,n,this.canvas.width,this.canvas.height),(r=this.star)==null||r.update(t),this.perfM.update(t)}updateAircraft(t){let i=0;this.input.isKeyDown(vt.A)&&(i=-1),this.input.isKeyDown(vt.D)&&(i=1),this.aircraft.turnTo(i),this.aircraft.update(t)}handleBounds(t,i){const[n,r]=this.aircraft.size;this.aircraft.position.x+n>t?this.aircraft.position.x=t-n:this.aircraft.position.x<0&&(this.aircraft.position.x=0),this.aircraft.position.y+r>i?this.aircraft.position.y=i-r:this.aircraft.position.y<0&&(this.aircraft.position.y=0)}isOffScreen(t,i,n,r=0){const[s,a]=[this.canvas.width,this.canvas.height],[p,h]=this.camera.position.unpack();return t.x+i<p-r||t.x>p+s+r||t.y+n<h-r||t.y>h+a+r}render(t){var i;t.clearRect(0,0,this.canvas.width,this.canvas.height),t.save(),t.translate(-this.camera.position.x,-this.camera.position.y);for(const n of this.clouds)this.isOffScreen(n.position,n.size,n.size,100)||n.draw(t);for(const n of this.explosions)n.isFinished||n.draw(t);(i=this.star)==null||i.draw(t),this.aircraft.draw(t);for(const n of this.missiles)n.draw(t);t.restore(),this.drawUI(t),this.perfM.draw(t)}drawUI(t){const i=yi(Math.floor((Date.now()-this.startTime)/1e3)).join(":"),n=this.getScore();t.save(),t.font="bold 36px Monaco",t.textAlign="left",t.textBaseline="top",t.fillStyle="rgba(0, 0, 0, 0.6)",t.fillRect(20,100,t.measureText(`Score: ${n}`).width+40,100),t.fillStyle="white",t.shadowColor="rgba(0, 0, 0, 0.8)",t.shadowBlur=10,t.fillText(`Time: ${i}`,30,110),t.fillText(`Score: ${n}`,30,150),t.restore()}getScore(){return 10}populateClouds(){const[t,i]=this.getWorldSize(),r=Math.ceil(t*i*1e-4),s=Math.ceil(Math.sqrt(r)*1.5),a=Math.ceil(r/s),p=t/s,h=i/a;for(let o=0;o<a;o++)for(let u=0;u<s&&!(this.clouds.length>=r);u++){const f=(u+Math.random()*.8)*p,l=(o+Math.random()*.8)*h;this.clouds.push(new bi(new F(f,l),this.canvas.height))}}spawnStar(){if(this.star)return;const[t,i]=this.canvasMidpoint;setTimeout(()=>{this.star=new ki(new F(t-100,i-100))},0)}startMissileSpawn(){const[t,i]=this.getWorldSize();setInterval(()=>{if(this.missiles.size>=this.maxMissilePool)return;const n=Math.random()*t,r=Math.random()*i;this.missiles.add(new _t(new F(n,r),this.aircraft.position))},this.missileSpawnIntv)}drawGrid(t){t.strokeStyle="#444",t.lineWidth=1;let n=Math.floor(this.camera.position.x/100)*100,r=Math.floor(this.camera.position.y/100)*100;for(let s=n;s<this.camera.position.x+this.canvas.width;s+=100)t.beginPath(),t.moveTo(s,this.camera.position.y),t.lineTo(s,this.camera.position.y+this.canvas.height),t.stroke();for(let s=r;s<this.camera.position.y+this.canvas.height;s+=100)t.beginPath(),t.moveTo(this.camera.position.x,s),t.lineTo(this.camera.position.x+this.canvas.width,s),t.stroke()}getWorldSize(){return[this.canvas.width*this.worldSizeFactor,this.canvas.height*this.worldSizeFactor]}get canvasMidpoint(){return[this.canvas.width/2,this.canvas.height/2]}}var Di=fi('<main><canvas class="svelte-1tg252x"></canvas></main>');function Ai(e,t){Lt(t,!0);let i,n,r,s=kt(I(window.innerWidth)),a=kt(I(window.innerHeight));gi(()=>{if(!n){console.log("Canvas element not found !");return}const u=n.getContext("2d");if(!u){console.log("Failed to acquire 2D rendering context");return}r=new Pi(n),requestAnimationFrame(function f(l){i||(i=l);const d=l-i;i=l,r.update(d),r.render(u),requestAnimationFrame(f)}),window.addEventListener("resize",p)});function p(){P(s,I(window.innerWidth)),P(a,I(window.innerHeight))}var h=Di(),o=Fe(h);_i(o,u=>n=u,()=>n),We(()=>{zt(o,"width",L(s)),zt(o,"height",L(a))}),hi(e,h),Ut()}ci(Ai,{target:document.getElementById("app")});
